@inject IGameService GameService

<button class="list-group-item list-group-item-action @(SelectedPostId == Post.PostID ? _active : string.Empty)"
    type="button" @onclick="OnSelectedPostChange">
    <div class="d-inline-flex gap-2 align-items-end">
        <img class="rounded-3" alt="GameIcon" width="40" height="40"
             src="@(_gameIcon ?? GameService.DefaultGameIconUri)">
        <div class="fs-4">@Post.GameName</div>
    </div>
    <div class="border-top border-bottom border-dark-subtle py-1">
        <div>@Post.MatchType</div>
        <div><i class="bi bi-file-person-fill"></i>: @Post.CurrentPeople / @Post.TotalPeople</div>
    </div>
    <small class="text-muted">上次更新 @((DateTime.Now - Post.LastUpdate).TotalMinutes.ToString("F0")) 前 ...</small>
</button>

@code {
    [Parameter, EditorRequired]
    public Post Post { get; set; } = new Post();
    [Parameter]
    public int SelectedPostId { get; set; } = -1;
    [Parameter]
    public EventCallback<int> SelectedPostIdChange { get; set; }

    private string _active = "active";

    private string? _gameIcon;

    protected override async Task OnParametersSetAsync()
    {
        _gameIcon = await GameService.GetGameIconAsync(Post.GameName);
    }

    private async Task OnSelectedPostChange()
    {
        int nextPostId = SelectedPostId == Post.PostID ? -1 : Post.PostID;
        await SelectedPostIdChange.InvokeAsync(nextPostId);
    }
}